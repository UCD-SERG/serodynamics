% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_predicted_curve.R
\name{plot_predicted_curve}
\alias{plot_predicted_curve}
\title{Generate Predicted Antibody Response Curves (Median + 95\% CI)}
\usage{
plot_predicted_curve(
  model,
  ids,
  antigen_iso,
  dataset = NULL,
  overlay_strata = FALSE,
  legend_obs = "Observed data",
  legend_median = "Median prediction",
  show_quantiles = TRUE,
  log_y = FALSE,
  log_x = FALSE,
  show_all_curves = FALSE,
  alpha_samples = 0.3,
  xlim = NULL,
  ylab = NULL,
  facet_by_id = length(ids) > 1,
  ncol = NULL
)
}
\arguments{
\item{model}{An \code{sr_model} object (returned by \code{\link[=run_mod]{run_mod()}}) containing
samples from the posterior distribution of the model parameters.}

\item{ids}{The participant IDs to plot; for example, \code{"sees_npl_128"}.
Use \code{"newperson"} to plot marginal ("new person") predictions.}

\item{antigen_iso}{The antigen isotype to plot; for example, "HlyE_IgA" or
"HlyE_IgG".}

\item{dataset}{(Optional) A \link[dplyr:tbl_df]{dplyr::tbl_df} with observed antibody response
data.
Must contain:
\itemize{
\item \code{timeindays}
\item \code{value}
\item \code{id}
\item \code{antigen_iso}
}}

\item{overlay_strata}{\link{logical}; if \link{TRUE}, overlays marginal predictions
for each stratum in the same panel when \code{ids = "newperson"}.
Different strata are distinguished by color. Defaults to \link{FALSE}.}

\item{legend_obs}{Label for observed data in the legend.}

\item{legend_median}{Label for the median prediction line.}

\item{show_quantiles}{\link{logical}; if \link{TRUE} (default), plots the 2.5\%, 50\%,
and 97.5\% quantiles.}

\item{log_y}{\link{logical}; if \link{TRUE}, applies a \link{log10} transformation to
the y-axis.}

\item{log_x}{\link{logical}; if \link{TRUE}, applies a \link{log10} transformation to the
x-axis.}

\item{show_all_curves}{\link{logical}; if \link{TRUE}, overlays all
individual sampled curves.}

\item{alpha_samples}{Numeric; transparency level for individual
curves (default = 0.3).}

\item{xlim}{(Optional) A numeric vector of length 2 providing custom x-axis
limits.}

\item{ylab}{(Optional) A string for the y-axis label. If \code{NULL} (default),
the label is automatically set to "ELISA units" or "ELISA units (log scale)"
based on the \code{log_y} argument.}

\item{facet_by_id}{\link{logical}; if \link{TRUE}, facets the plot by 'id'.
Defaults to \link{TRUE} when multiple IDs are provided.}

\item{ncol}{\link{integer}; number of columns for faceting.}
}
\value{
A \link[ggplot2:ggplot]{ggplot2::ggplot} object displaying predicted antibody response
curves with a median curve and a 95\% credible interval band as default.
}
\description{
Plots a median antibody response curve with a 95\% credible interval
ribbon, using MCMC samples from the posterior distribution.
Optionally overlays observed data,
applies logarithmic spacing on the y- and x-axes,
and shows all individual
sampled curves. When \code{ids = "newperson"} and \code{overlay_strata = TRUE},
overlays marginal predictions for each stratum in the same panel.
}
\examples{
sees_model <- serodynamics::nepal_sees_jags_output
sees_data <- serodynamics::nepal_sees

# Plot (linear axes) with all individual curves + median ribbon
p1 <- plot_predicted_curve(
  model              = sees_model,
  dataset            = sees_data,
  id                 = "sees_npl_128",
  antigen_iso        = "HlyE_IgA",
  show_quantiles     = TRUE,
  log_y              = FALSE,
  log_x              = FALSE,
  show_all_curves    = TRUE
)
print(p1)

# Plot (log10 y-axis) with all individual curves + median ribbon
p2 <- plot_predicted_curve(
  model              = sees_model,
  dataset            = sees_data,
  id                 = "sees_npl_128",
  antigen_iso        = "HlyE_IgA",
  show_quantiles     = TRUE,
  log_y              = TRUE,
  log_x              = FALSE,
  show_all_curves    = TRUE
)
print(p2)

# Plot with custom x-axis limits (0-600 days)
p3 <- plot_predicted_curve(
  model              = sees_model,
  dataset            = sees_data,
  id                 = "sees_npl_128",
  antigen_iso        = "HlyE_IgA",
  show_quantiles     = TRUE,
  log_y              = FALSE,
  log_x              = FALSE,
  show_all_curves    = TRUE,
  xlim               = c(0, 600)
)
print(p3)

# Multi-ID, faceted plot (single antigen):
p4 <- plot_predicted_curve(
  model           = sees_model,
  dataset         = sees_data,
  id              = c("sees_npl_128", "sees_npl_131"),
  antigen_iso     = "HlyE_IgA",
  show_all_curves = TRUE,
  facet_by_id     = TRUE
)
print(p4)

# Stratified marginal overlay plot (newperson with multiple strata):
p5 <- plot_predicted_curve(
  model           = sees_model,
  ids             = "newperson",
  antigen_iso     = "HlyE_IgA",
  overlay_strata  = TRUE,
  show_quantiles  = TRUE,
  log_y           = FALSE
)
print(p5)

# Stratified marginal overlay with log y-axis:
p6 <- plot_predicted_curve(
  model           = sees_model,
  ids             = "newperson",
  antigen_iso     = "HlyE_IgA",
  overlay_strata  = TRUE,
  show_quantiles  = TRUE,
  log_y           = TRUE
)
print(p6)
}
