% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Run_Mod.R
\name{run_mod}
\alias{run_mod}
\title{Run Jags Model}
\usage{
run_mod(
  data,
  file_mod = serodynamics_example("model.jags"),
  nchain = 4,
  nadapt = 0,
  nburn = 0,
  nmc = 100,
  niter = 100,
  strat = NA,
  max_antigens,
  ...
)
}
\arguments{
\item{data}{A \code{\link[base:data.frame]{base::data.frame()}} with the following columns.}

\item{file_mod}{The name of the file that contains model structure.}

\item{nchain}{An \link{integer} between 1 and 4 that specifies
the number of mcmc chains to be run per jags model.}

\item{nadapt}{An \link{integer} specifying the number of adaptations per chain.}

\item{nburn}{An \link{integer} specifying the number of burn ins before sampling.}

\item{nmc}{An \link{integer} specifying number of samples in posterior chains}

\item{niter}{An \link{integer} specifying number of iterations.}

\item{strat}{A \link{character} string specifying the stratification variable,
entered in quotes.}

\item{max_antigens}{An \link{integer} specifying how many
antigen-isotypes will be modeled}

\item{...}{
  Arguments passed on to \code{\link[=prep_priors]{prep_priors}}
  \describe{
    \item{\code{mu_hyp_param}}{A \link{numeric} \link{vector} of 5 values representing the mean of
the hyperprior distribution of the population mean of the random
person-specific seroresponse curve parameters.
If specified must be 5 values long representing the following parameters:
\itemize{
\item y0 = baseline antibody concentration (default = 1.0)
\item y1 = peak antibody concentration (default = 7.0)
\item t1 = time to peak (default = 1.0)
\item r = shape parameter (default = -4.0)
\item alpha = decay rate (default = -1.0)
}}
    \item{\code{prec_hyp_param}}{A \link{numeric} \link{vector} of 5 values corresponding to
diagonal entries representing the precision matrix of the hyperprior
distribution of the person-specific seroresponse curve parameters.
If specified must be 5 values long:
\itemize{
\item defaults: y0 = 1.0, y1 = 0.00001, t1 = 1.0, r = 0.001, alpha = 1.0
}}
    \item{\code{omega_param}}{A \link{numeric} \link{vector} of 5 values corresponding to diagonal
entries representing the precision matrix of Wishart hyper-priors for
person-specific random effects.
If specified must be 5 values long:
\itemize{
\item defaults: y0 = 1.0, y1 = 50.0, t1 = 1.0, r = 10.0, alpha = 1.0
}}
    \item{\code{wishdf_param}}{A \link{numeric} \link{vector} of 1 value specifying Wishart
distribution degrees of freedom.
If specified, must be 1 value long.
\itemize{
\item default = 20.0
}}
    \item{\code{prec_logy_hyp_param}}{A \link{numeric} \link{vector} of 2 values corresponding to
the hyper-parameters for the precision (inverse variance) of the biomarkers,
on log-scale. If specified, must be 2 values long.
\itemize{
\item defaults = 4.0, 1.0
}}
  }}
}
\value{
\itemize{
\item A jags.post \code{\link[=list]{list()}} object or multiple jags.post \code{\link[=list]{list()}}
if stratified. Returned as a \code{\link[=list]{list()}} of class \link[runjags:runjags-class]{runjags::runjags}
\item A \code{\link[base:data.frame]{base::data.frame()}} titled \code{curve_params} that contains the posterior
distribution will be exported with the following attributes:
\item \code{iteration} = number of sampling iterations.
\item \code{chain} = number of mcmc chains run; between 1 and 4.
\item \code{indexid} = "newperson", indicating posterior distribution.
\item \code{antigen_iso} = antibody/antigen type combination being evaluated
\item \code{alpha} = posterior estimate of decay rate
\item \code{r} = posterior estimate of shape parameter
\item \code{t1} = posterior estimate of time to peak
\item \code{y0} = posterior estimate of baseline antibody concentration
\item \code{y1} = posterior estimate of peak antibody concentration
\item \verb{stratified variable} = the variable that jags was stratified by
\item A \link{list} of \code{attributes} that summarize the jags inputs, including:
\item \code{class}: Class of the output object.
\item \code{nChain}: Number of chains run.
\item \code{nParameters}: The amount of parameters estimated in the model.
\item \code{nIterations}: Number of iteration specified.
\item \code{nBurnin}: Number of burn ins.
\item \code{nThin}: Thinning number (niter/nmc)
}
}
\description{
run_mod() takes a data frame and adjustable mcmc inputs to
\code{\link[runjags:run.jags]{runjags::run.jags()}} as an mcmc
bayesian model to estimate antibody dynamic curve parameters.
The \code{\link[rjags:jags.model]{rjags::jags.model()}} models seroresponse dynamics to an
infection. The antibody dynamic curve includes the following parameters:
\itemize{
\item y0 = baseline antibody concentration
\item y1 = peak antibody concentration
\item t1 = time to peak
\item r = shape parameter
\item alpha = decay rate
}
}
\examples{
if (!is.element(runjags::findjags(), c("", NULL))) {
  library(runjags)
  set.seed(1)
  library(dplyr)
  strat1 <- serocalculator::typhoid_curves_nostrat_100 |>
    sim_case_data(n = 100) |>
    mutate(strat = "stratum 2")
  strat2 <- serocalculator::typhoid_curves_nostrat_100 |>
    sim_case_data(n = 100) |>
    mutate(strat = "stratum 1")

  dataset <- bind_rows(strat1, strat2)

  fitted_model <- run_mod(
    data = dataset, # The data set input
    file_mod = serodynamics_example("model.jags"),
    nchain = 4, # Number of mcmc chains to run
    nadapt = 100, # Number of adaptations to run
    nburn = 100, # Number of unrecorded samples before sampling begins
    nmc = 1000,
    niter = 2000, # Number of iterations
    strat = "strat"
  ) # Variable to be stratified
}
}
\author{
Sam Schildhauer
}
